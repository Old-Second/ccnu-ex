(()=>{const t=localStorage;window;const n=document,k=FileReader,H=fetch,r=n.documentElement,o=n.body,D=n.head,l=e=>n.createElement(e),F=e=>new Image,a=(e,t,n)=>e["on"+t]=n,c=e=>e.getBoundingClientRect(),i=setTimeout,s=Math,O=URL,d="click",g="load",v="level",m="style",u="src",P="href",W="then",f="setAttribute",z="getAttribute",G="removeAttribute";const p="data-";const J=p+"running",K=p+g+"ing",h="children",N="stopPropagation",Q="createObjectURL",w="display",x="innerHTML",b="width",y="height",V="left",$=0,R=2,X=1e3;const A="",Y="a",L="target",Z=/weibo|qq/i.test(navigator.userAgent),B=(e,t=n)=>t.querySelector(e);const _="china-ex-levels",I=2080,q=1080,C=R,ee=B("#地点");var te=B("#保存"),e=B("#输出");const ne=B("img",e),E=B("#设置等级"),M=l("canvas"),S=M.getContext("2d"),oe=(M[b]=I*C,M[y]=q*C,B("#top")[h][$]),ae=E[h][$],T=E[m],re=e[m],le=e=>{T[w]=A},ce={},ie=e=>[...ee[h]],U=e=>ie().map(e=>e[z](v)||$),se=e=>{t.setItem(_,U().join(A))};a(ee,d,e=>{e[N]();var e=e[L],t=c(e),e=(ce.省元素=e,ae[x]=e.id,T[w]="block",c(E)),n=s.round(r.scrollLeft+t[V]+t[b]/R-e[b]/R),n=s.min(n,o.offsetWidth-e[b]-6),t=(n=s.max(n,6),s.round(r.scrollTop+t.top+t[y]/R-e[y]/R)),t=s.min(t,o.offsetHeight-e[y]-6);t=s.max(t,6),T[V]=n+"px",T.top=t+"px"}),a(n,d,le);const de=e=>{var t=U().reduce((e,t)=>e+(+t||$),$);分数[x]="得分: "+t,称号1[x]=100<t?"华":80<t?"桂":60<t?"登":40<t?"小":20<t?"初":"足",称号2[x]=100<t?"师":80<t?"子":60<t?"山":40<t?"有":20<t?"入":"不",称号3[x]=100<t?"万":80<t?"山":60<t?"强":40<t?"探":20<t?"华":"出",称号4[x]=100<t?"事":80<t?"庄":60<t?"者":40<t?"索":20<t?"师":"户",称号5[x]=100<t?"通":80<t?"主":""},ge=e=>{var t=U().reduce((e,t)=>e+(+t?1:$),$);进度[x]=`探索进度: ${t}/49`};a(E,d,e=>{e[N]();e=e[L][z](p+v);e&&(ce.省元素[f](v,e),de(),ge(),le(),se())});{const fe=t.getItem(_)||A;ie().forEach((e,t)=>{e[f](v,fe[t]||$)})}de(),ge();const ve=(e,t)=>{var n=new k;a(n,g,e=>t(e[L].result)),n.readAsDataURL(e)};var j,me,ue;j="font1",me=e=>{B(m,oe)[x]=e;var t=l(m);t[x]=e,D.appendChild(t),i(e=>r[G](K),R*X)},ue=e=>me(`@font-face{font-family:${j};${u}:url(${e})}`),H(j+".ttf?v=2rce8n")[W](e=>e.blob())[W](e=>ve(e,ue));a(te,d,e=>{r[f](J,!0);var t=(e=>{e=new Blob([e],{type:"image/svg+xml"});return O[Q](e)})(`<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2080 1080" ${b}="2080px" ${y}="1080px">${oe[x]}</svg>`);{var n=e=>{S.fillStyle="#6eab8a",S.fillRect($,$,I*C,q*C),S.drawImage(e,$,$,I,q,$,$,I*C,q*C),M.toBlob(e=>{const a=O[Q](e);ne[u]=a,re[w]=A,i(e=>{var t,n,o;t=a,n="[Muxi][华师制霸].png",o=l(Y),Z||(o.download=n),o[P]=t,o[d](),r[G](J)},50)})};const o=F();a(o,g,e=>i(e=>n(o),X/R)),o[u]=t}}),a(B(Y,e),d,e=>{re[w]="none"})})();